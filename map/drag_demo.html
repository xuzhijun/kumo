<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
 <head>
 <title>drag demo change size or change layout - http://www.never-online.net</title>
 <meta http-equiv="ImageToolbar" content="no" />
 <meta name="author" content="never-online, BlueDestiny"/>
 <meta name="keywords" content="drag, custom layout, never modules, Mozilla CSS, C#, .net, Reference, BlueDestiny, never-online"/>
 <meta name="description" content="drag demo change size or change layout, javascript reference, c sharp artilces"/>
 <meta name="creator.name" content="never-online, BlueDestiny" />
 <style type="text/css" media="all" title="Default">
@import "http://www.never-online.net/code/js/dragdemo/main.css";
div#demoDrag {
	cursor:move;
	position:absolute;
	border:1px double #000;
	background-color:buttonface;
	width:200px;
	height:100px;
	color:#CC0000;
	text-align:center;
}
</style>
 </head>

 <body id="www.never-online.net">
<div id="header">
     <h1> drag demo change size or change layout </h1>
     by JK, never-online, <a href="http://www.never-online.net">www.never-online.net</a>
     <hr/>
 </div>
<div class="wrapper">
     <div class="content">
        <input type="radio" value="size" name="custom" id="size"/>
        <label for="size">拖动改变尺寸</label>
        <input type="radio" value="layout" name="custom" id="layout" checked/>
        <label for="layout">拖动改变布局</label>
    </div>
 </div>
<div id="demoDrag" onmousedown="handlestart(event, this)">Easy to write the drag code, <br/>
     this is a simple demo, <br/>
     by never-online,<br/>
     http://www.never-online.net</div>
<script type="text/javascript">
 //<![CDATA[

 function getAbsolutePosition (e) {

 var width = e.offsetWidth;
 var height = e.offsetHeight;
 var left = e.offsetLeft;
 var top = e.offsetTop;
 while (e=e.offsetParent) {
 left += e.offsetLeft;
 top += e.offsetTop;
 };
 var right = left+width;
 var bottom = top+height;
 return {
 'width': width, 'height': height,
 'left': left, 'top': top,
 'right': right, 'bottom': bottom
 }
 };

 function getDocRect (wnd) {
 wnd = wnd || window;
 doc = wnd.document;
 return { 
 left :doc.documentElement.scrollLeft||doc.body.scrollLeft||wnd.pageXOffset||wnd.scrollX||0+10,
 top :doc.documentElement.scrollTop||doc.body.scrollTop||wnd.pageYOffset||wnd.scrollY||0,
 width :doc.documentElement.clientWidth||doc.body.clientWidth||wnd.innerWidth||doc.width||0,
 height :doc.documentElement.clientHeight||doc.body.clientHeight||wnd.innerHeight||doc.height||0 
 }
 };

 var elDrag = null; 
 var bLayout = true; 
 var isIE = !!window.ActiveXObject;
 var bDraging = false;

 var handlestart = function (evt, el) {
 var rect = getDocRect();
 var p = getAbsolutePosition(el);
 bLayout = document.getElementById('layout').checked?true:false;
 bDraging = true;
 evt = window.event||evt; 
 elDrag = el; 
 //if (elDrag.setCapture) elDrag.setCapture();
 //elDrag.onlosecapture = function() { handlestop(); }
 elDrag.deltaX = evt.clientX+rect.left-(bLayout?p.left:p.width);
 elDrag.deltaY = evt.clientY+rect.top-(bLayout?p.top:p.height);
 };
 
 var handledraging = function (evt) {
 if (!bDraging) return false; 
 evt = window.event||evt;
 try {
 var rect = getDocRect();
 var x, y;
 x = evt.clientX+rect.left-elDrag.deltaX;
 y = evt.clientY+rect.top-elDrag.deltaY;
 if (bLayout) {
 if (evt.clientX>1 && evt.clientX<=rect.width)
 elDrag.style.left = x +'px';
 if (evt.clientY>1 && evt.clientY<=rect.height)
 elDrag.style.top = y +'px'; 
 } else {
 if (x>1 && evt.clientX<=rect.width) 
 elDrag.style.width = x +'px';
 if (y>1 && evt.clientY<=rect.height) 
 elDrag.style.height = y +"px";
 }
 } catch (ex) {};
 };

 var handlestop = function (evt) {
 evt = evt || window.event;
 if (!bDraging) return false;
// if (elDrag.releaseCapture) elDrag.releaseCapture();
// document.body.focus();
 bDraging = false;
 };

 document.onmousemove = handledraging;
 document.onmouseup = handlestop;

 //]]>
 </script>
</body>
</html>